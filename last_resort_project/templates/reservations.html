<!-- checked: Reservations list verified -->

{% from "_components/sortable.html" import sortable %}

{% extends "base.html" %}
{% block content %}
<div class="row align-items-center mb-4">
    <div class="col-md-5">
        <h2>Reservations <small class="text-muted">({{ reservations|length }})</small></h2>
    </div>
    <div class="col-md-7">
        <div class="d-flex gap-2 justify-content-end">
            <form action="/reservations" method="get" class="d-flex gap-2 flex-grow-1 justify-content-end">
                <input type="text" name="search" class="form-control" placeholder="Guest Name, ID or Org..." value="{{ request.args.get('search', '') }}">
                <button type="submit" class="btn btn-primary">Search</button>
            </form>
            <!-- Updated button style to match Room Management -->
            <a href="/reservations/new" class="btn btn-primary text-nowrap">+ New</a>
        </div>
    </div>
</div>

<div class="table-scroll-container card">
    <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
            <tr>
                <th class="text-nowrap" style="width: 1%;">
                    {{ sortable("ID", "reservationId") }}
                </th>
                <th>
                    {{ sortable("Guest / Party", "displayName") }}
                </th>
                <th class="text-nowrap">
                    {{ sortable("Check In", "checkIn") }}
                </th>
                <th class="text-nowrap">
                    {{ sortable("Check Out", "checkOut") }}
                </th>
                <th class="text-nowrap" style="width: 1%;">
                    {{ sortable("Status", "status") }}
                </th>
                <th class="text-nowrap" style="width: 1%;">
                    Action
                </th>
            </tr>
        </thead>        
        <tbody>
            {% for r in reservations %}
            <tr>
                <td class="text-nowrap text-muted small">#{{ r.resvId }}</td>
                <td>
                    <strong>{{ r.displayName }}</strong>
                    <br>
                    <span class="badge bg-light text-dark border rounded-0 text-uppercase" style="font-size: 0.65rem;">{{ r.partyType }}</span>
                </td>
                <td class="text-nowrap">{{ r.startDate }}</td>
                <td class="text-nowrap">{{ r.endDate }}</td>
                <td class="text-nowrap">
                    <span class="badge rounded-0 {% if r.status == 'CheckedIn' %}bg-primary{% elif r.status == 'Booked' %}bg-success{% else %}bg-secondary{% endif %}">
                        {{ r.status }}
                    </span>
                </td>
                <td class="text-nowrap">
                    {% if r.status == 'Booked' %}
                    <a href="/checkin/{{ r.resvId }}" class="btn btn-sm btn-outline-dark rounded-0 py-0" style="font-size: 0.75rem;">Check In</a>
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr><td colspan="6" class="text-center p-3 text-muted">No reservations found.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div class="mt-2 text-muted small text-end">Scroll to view more reservations â†•</div>
{% endblock %}